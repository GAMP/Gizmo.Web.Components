@namespace Gizmo.Web.Components
@inherits GizInputBase<TValue>

@typeparam TItemType
@typeparam TValue

<div class="@Class @ClassName"
     id="@Id"
     @ref="@Ref">
    <CascadingValue Value="@((ISelect<TValue>)this)" IsFixed="true">
        <GizInput Label="@Label"
                  IsDisabled="@IsDisabled"
                  IsFullWidth="@IsFullWidth"
                  HasOutline="@HasOutline"
                  HasShadow="@HasShadow"
                  IsTransparent="@IsTransparent"
                  Size="@Size"
                  IsValid="@_isValid"
                  ValidationMessage="@_validationMessage"
                  RightSVGIcon="Icons.Search">

            <input type="text"
                   value="@_text"
                   readonly="@IsReadOnly"
                   disabled="@IsDisabled"
                   @oninput="OnInputHandler"
                   @onkeydown="OnInputKeyDownHandler"
                   />

        </GizInput>

        <Popup MaximumHeight="@MaximumHeight"
               @bind-IsOpen="_isOpen"
               OpenDirection="@OpenDirection"
               Class="@PopupClassName"
               Style="@PopupStyleValue">
            <List @ref="_popupContent"
                  CanClick="true"
                  CanSelect="true">
                @if (_items != null)
                {
                    @foreach (var item in GetFiltered(_text))
                    {
                        if (ItemTemplate != null)
                        {
                            @ItemTemplate(item);
                        }
                        else
                        {
                            <SelectItem TValue="@TValue" Value="@GetItemValue(item)" Text="@GetItemText(item)" />
                        }
                    }
                }
            </List>
        </Popup>
    </CascadingValue>
</div>